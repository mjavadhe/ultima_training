{% extends 'base.html' %}
{% block title %}Workshops & Events - Ultima Training{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="d-flex flex-wrap align-items-end justify-content-between mb-4">
    <h1 class="mb-3 mb-md-0">Workshops & Events</h1>
    <form method="get" class="row g-2">
      <div class="col-auto">
        <select name="type" class="form-select">
          <option value="">All</option>
          <option value="public_workshop" {% if request.GET.type == 'public_workshop' %}selected{% endif %}>Public Workshop</option>
          <option value="corporate_training" {% if request.GET.type == 'corporate_training' %}selected{% endif %}>Corporate Training</option>
          <option value="speaking_engagement" {% if request.GET.type == 'speaking_engagement' %}selected{% endif %}>Speaking Engagement</option>
          <option value="webinar" {% if request.GET.type == 'webinar' %}selected{% endif %}>Webinar</option>
        </select>
      </div>
      <div class="col-auto">
        <button class="btn btn-purple" type="submit">
          <i class="fas fa-filter me-2"></i>Filter
        </button>
      </div>
    </form>
  </div>

  {% if events %}
    <div class="row">
      {% for event in events %}
        <div class="col-md-6 col-lg-4 mb-4">
          <div class="event-card h-100">
            {% if event.featured_image %}
              <img src="{{ event.featured_image.url }}" class="w-100" style="height:180px; object-fit:cover;" alt="{{ event.title }}">
            {% endif %}
            <div class="p-3">
              <span class="event-type-badge">{{ event.get_event_type_display }}</span>
              <h5 class="mt-2">{{ event.title }}</h5>
              <p class="text-muted">{{ event.description|truncatewords:25 }}</p>
              <div class="d-flex justify-content-between align-items-center">
                <small class="text-muted">
                  <i class="far fa-calendar me-1"></i>{{ event.start_datetime|date:"M d, Y H:i" }}
                </small>
                <small class="text-muted">
                  <i class="fas fa-map-marker-alt me-1"></i>{{ event.location|default:"Online" }}
                </small>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    {% if events.has_other_pages %}
      <nav aria-label="pagination">
        <ul class="pagination">
          {% if events.has_previous %}
            <li class="page-item"><a class="page-link" href="?page={{ events.previous_page_number }}{% if request.GET.type %}&type={{ request.GET.type }}{% endif %}">Previous</a></li>
          {% endif %}
          <li class="page-item disabled"><span class="page-link">Page {{ events.number }} of {{ events.paginator.num_pages }}</span></li>
          {% if events.has_next %}
            <li class="page-item"><a class="page-link" href="?page={{ events.next_page_number }}{% if request.GET.type %}&type={{ request.GET.type }}{% endif %}">Next</a></li>
          {% endif %}
        </ul>
      </nav>
    {% endif %}
  {% else %}
    <div class="text-center py-5">
      <i class="fas fa-calendar-alt fa-3x text-muted mb-3"></i>
      <h4 class="text-muted">No events found</h4>
    </div>
  {% endif %}
</div>
{% endblock %}